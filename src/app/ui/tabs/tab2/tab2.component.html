<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title slot="start">
      Autom8
    </ion-title>
  </ion-toolbar>
</ion-header>
<ion-header [translucent]="true" id="_header" #myHeader>
  <ion-list class="ion-list-fixed">
    <ion-item detail="false" class="ion-item-fixed ion-item">

      <ion-button class="btn-pushed" size="default" color="light" (click)="toggleFavorites()" *ngIf="!editingFavorites">
        <ion-icon name="star" color="warning"></ion-icon>
      </ion-button>

      <ion-button (click)="changeOrderType()" size="default" color="light" *ngIf="!editingFavorites">
        <ion-icon *ngIf="this.orderType==='grid'" name="list"></ion-icon>
        <ion-icon *ngIf="this.orderType==='list'" name="grid-outline"></ion-icon>
      </ion-button>

      <ion-button size="default" color="light" *ngIf="!editingFavorites">Create scene</ion-button>

      <ion-button size="default" color="light" *ngIf="editingFavorites" (click)="saveFavorites()">Save</ion-button>

      <ion-toggle slot="end" (ionChange)="toggleAll($event)" class="ion-toggle-all ion-toggle" *ngIf="!editingFavorites">
      </ion-toggle>

      <ion-label class="ion-label" *ngIf="editingFavorites" style="margin-left: 10px;">Add to favorites ({{functions.favorites.length}})</ion-label>

    </ion-item>

  </ion-list>
</ion-header>
<ion-content [fullscreen]="true"
[scrollEvents]="true" (ionScroll)="ionScrollStarted($event, myHeader)">

  <ion-grid class="ion-list-pushed ion-grid" id="grid_display_list">
    <ion-row>
      <ion-col size='{{12 / gridColCount}}' *ngFor='let item of functions.outlets' class="ion-col">

        <!-- Grid -->
        <div (click)="functions.manualToggle($event)" class="ion-col-div" [class]="functions.isToggledAll ? 'light-active' : ''"
          name="outputToggleDiv" style="background: {{item.backgroundColor}};"
          *ngIf="orderType === 'grid' && !editingFavorites" [ngClass]="functions.isToggledAll ? 'light-active' : '' ">

          <ion-icon *ngIf="item.icon" name="{{item.icon}}" style="font-size: {{12 / gridColCount}}vh"></ion-icon>

           <ion-label class="text-shadow ion-label">{{item.toggleName}}</ion-label>
        </div>

        <!-- Edit Favorites Grid -->
        <div class="ion-col-div" style="background: {{item.backgroundColor}};"
          *ngIf="orderType === 'grid' && editingFavorites">

          <ion-grid class="ion-grid">
            <ion-row>
              <ion-col size="12" class="ion-col">
                <span>

                  {{item.toggleName}}
                </span>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col size="12" class="ion-col">
                <ion-checkbox style="--background-checked: {{item.backgroundColor}}"
                  (ionChange)="functions.addToFavoritesList(item, $event)" [checked]="item.isFavorite" *ngIf="editingFavorites"
                  class="ion-checkbox">
                </ion-checkbox>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
        <!-- End Edit Favorites Grid -->

        <!-- List -->
        <div class="ion-item-div" style="background: {{item.backgroundColor}};" *ngIf="orderType === 'list'">

          <ion-grid class="ion-no-margin ion-no-padding full-width ion-grid" *ngIf="!editingFavorites">
            <ion-row>
              <!-- Column -->
              <ion-col size="10"
                (click)="!item.isDimmer && !item.remoteShortcuts ? functions.manualToggle($event, myToggle) : ''"
                class="ion-col">
                <!-- Label -->
                <ion-label class="text-shadow ion-label">{{item.toggleName}}
                </ion-label>
              </ion-col>

              <!-- Column -->
              <ion-col size="2" style="text-align: right;" class="ion-col">
                <!-- Toggle -->
                <ion-toggle name="outputToggle" #myToggle (ionChange)="functions.toggleLight($event, myToggle)"
                  [checked]="functions.isToggledAll" class="ion-toggle">
                </ion-toggle>
              </ion-col>
            </ion-row>
            <ion-row style="height: 50px;">

              <!-- Column -->
              <ion-col size="10" class="full-height ion-col" 
              (click)="!item.isDimmer && !item.remoteShortcuts ? functions.manualToggle($event, myToggle) :
                ''">

                <!-- Range -->
                <ion-range min="0" max="100" step="1" value="{{item.dimmingValue}}" #myRange *ngIf="item.isDimmer"
                  (ionChange)="functions.changeDimmingValue($event, myToggle)" class="ion-range" pin="true">
                  <ion-icon slot="start" size="small" name="sunny"></ion-icon>
                  <ion-icon slot="end" name="sunny"></ion-icon>
                </ion-range>

                <!-- TV remote buttons -->
                <div *ngIf="item.remoteShortcuts" class="remote-shortcuts full-height">
                  <ion-button size="small" *ngFor="let remoteBtn of item.remoteShortcuts" fill="clear">
                    <ion-icon name="{{remoteBtn}}"></ion-icon>
                  </ion-button>
                  <ion-button (click)="functions.remoteButtonPressed($event, item.iD)" fill="clear">
                    <ion-icon name="keypad"></ion-icon>
                  </ion-button>
                </div>
              </ion-col>

              <!-- Column -->
              <ion-col size="2" class="ion-col">
                <!-- Action plan icon -->
                <ion-icon routerLink='./action-plan' class="ion-item-config-icon ion-no-margin" name="chevron-forward">
                </ion-icon>
              </ion-col>
            </ion-row>
          </ion-grid>

          <!-- Edit Favorites List -->
          <ion-grid class="ion-no-margin ion-no-padding full-width ion-grid" *ngIf="editingFavorites">
            <ion-row>
              <!-- Column -->
              <ion-col size="12" style="text-align: right;" class="ion-col">
                <ion-item style="--padding-start: 10px;" class="ion-item">
                  <!-- Toggle -->
                  <ion-label class="no-padding no-margin text-shadow ion-label">{{item.toggleName}}
                  </ion-label>
                  <ion-checkbox style="--background-checked: {{item.backgroundColor}}"
                    (ionChange)="functions.addToFavoritesList(item, $event)" [checked]="item.isFavorite" class="ion-checkbox">
                  </ion-checkbox>
                </ion-item>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
