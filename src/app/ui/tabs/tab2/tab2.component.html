<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title slot="start">
      Autom8
    </ion-title>
    <ion-button slot="end" *ngIf="showFavorites" fill="clear" class="fav-edit-btn" (click)="editCurrentFavorites()"
      style="--padding-end: 10px;">
      <ion-icon ios="create-outline" md="create" size="large" class="edit-icon">
      </ion-icon>
    </ion-button>


  </ion-toolbar>
</ion-header>
<ion-header [translucent]="true" id="_header">
  <ion-list class="ion-list-fixed">
    <ion-item detail="false" class="ion-item-fixed">

      <ion-button class="btn-pushed" size="default" color="light" (click)="toggleFavorites()" *ngIf="!editingFavorites">
        <ion-icon name="star" [color]="showFavorites ? 'warning' : 'dark'"></ion-icon>
      </ion-button>

      <ion-button (click)="changeOrderType()" size="default" color="light" *ngIf="!editingFavorites">
        <ion-icon *ngIf="this.orderType==='grid'" name="list"></ion-icon>
        <ion-icon *ngIf="this.orderType==='list'" name="grid-outline"></ion-icon>
      </ion-button>

      <ion-button size="default" color="light" *ngIf="!editingFavorites">Create scene</ion-button>

      <ion-button size="default" color="light" *ngIf="editingFavorites" (click)="saveFavorites()">Save</ion-button>

      <ion-toggle slot="end" (ionChange)="toggleAll($event)" class="ion-toggle-all" *ngIf="!editingFavorites">
      </ion-toggle>

      <ion-label *ngIf="editingFavorites" style="margin-left: 10px;">Add to favorites ({{favorites.length}})</ion-label>

    </ion-item>

  </ion-list>
</ion-header>
<ion-content [fullscreen]="true"
[scrollEvents]="true">

  <ion-grid class="ion-list-pushed" id="grid_display_list">
    <ion-row>
      <ion-col size='{{12 / gridColCount}}' *ngFor='let item of displayList'>

        <!-- Grid -->
        <div (click)="manualToggle($event)" class="ion-col-div" [class]="isToggledAll ? 'light-active' : ''"
          name="outputToggleDiv" style="background: {{item.backgroundColor}};"
          *ngIf="orderType === 'grid' && !editingFavorites" [ngClass]="isToggledAll ? 'light-active' : '' ">

          <ion-icon *ngIf="item.icon" name="{{item.icon}}" style="font-size: {{12 / gridColCount}}vh"></ion-icon>

           <ion-label class="text-shadow">{{item.toggleName}}</ion-label>
        </div>

        <!-- Edit Favorites Grid -->
        <div class="ion-col-div" style="background: {{item.backgroundColor}};"
          *ngIf="orderType === 'grid' && editingFavorites">

          <ion-grid>
            <ion-row>
              <ion-col size="12">
                <span>

                  {{item.toggleName}}
                </span>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col size="12">
                <ion-checkbox style="--background-checked: {{item.backgroundColor}}"
                  (ionChange)="addToFavoritesList(item, $event)" [checked]="item.isFavorite" *ngIf="editingFavorites">
                </ion-checkbox>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
        <!-- End Edit Favorites Grid -->

        <!-- List -->
        <div class="ion-item-div" style="background: {{item.backgroundColor}};" *ngIf="orderType === 'list'" (contextmenu)="pressedMe($event)">

          <ion-grid class="ion-no-margin ion-no-padding full-width" *ngIf="!editingFavorites">
            <ion-row>
              <!-- Column -->
              <ion-col size="10"
                (click)="!item.isDimmer && !item.remoteShortcuts ? manualToggle($event, myToggle) : ''">
                <!-- Label -->
                <ion-label class="text-shadow">{{item.toggleName}}
                </ion-label>
              </ion-col>

              <!-- Column -->
              <ion-col size="2" style="text-align: right;">
                <!-- Toggle -->
                <ion-toggle name="outputToggle" #myToggle (ionChange)="toggleLight($event, myToggle)"
                  [checked]="isToggledAll">
                </ion-toggle>
              </ion-col>
            </ion-row>
            <ion-row style="height: 50px;">

              <!-- Column -->
              <ion-col size="10" class="full-height" (click)="!item.isDimmer && !item.remoteShortcuts ? manualToggle($event, myToggle) :
                ''">

                <!-- Range -->
                <ion-range min="0" max="100" step="1" value="{{item.dimmingValue}}" #myRange *ngIf="item.isDimmer"
                  (ionChange)="changeDimmingValue($event, myToggle)">
                  <ion-icon slot="start" size="small" name="sunny"></ion-icon>
                  <ion-icon slot="end" name="sunny"></ion-icon>
                </ion-range>

                <!-- TV remote buttons -->
                <div *ngIf="item.remoteShortcuts" class="remote-shortcuts full-height">
                  <ion-button size="small" *ngFor="let remoteBtn of item.remoteShortcuts" fill="clear">
                    <ion-icon name="{{remoteBtn}}"></ion-icon>
                  </ion-button>
                  <ion-button (click)="remoteButtonPressed($event, item.ID)" fill="clear">
                    <ion-icon name="keypad"></ion-icon>
                  </ion-button>
                </div>
              </ion-col>

              <!-- Column -->
              <ion-col size="2">
                <!-- Action plan icon -->
                <ion-icon routerLink='./action-plan' class="ion-item-config-icon ion-no-margin" name="chevron-forward">
                </ion-icon>
              </ion-col>
            </ion-row>
          </ion-grid>

          <!-- Edit Favorites List -->
          <ion-grid class="ion-no-margin ion-no-padding full-width" *ngIf="editingFavorites">
            <ion-row>
              <!-- Column -->
              <ion-col size="12" style="text-align: right;">
                <ion-item style="--padding-start: 10px;">
                  <!-- Toggle -->
                  <ion-label class="no-padding no-margin text-shadow">{{item.toggleName}}
                  </ion-label>
                  <ion-checkbox style="--background-checked: {{item.backgroundColor}}"
                    (ionChange)="addToFavoritesList(item, $event)" [checked]="item.isFavorite">
                  </ion-checkbox>
                </ion-item>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
